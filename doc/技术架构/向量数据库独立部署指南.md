# å‘é‡æ•°æ®åº“ç‹¬ç«‹éƒ¨ç½²æŒ‡å—

## ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ç‹¬ç«‹éƒ¨ç½²?

å½“å‰é—®é¢˜: DeeChatåœ¨Intel Xeon E5-2650 v2æœåŠ¡å™¨ä¸Šå› ä¸ºåŸç”Ÿä¾èµ–(chromadb-default-embed)å¯¼è‡´å´©æºƒã€‚

**è§£å†³æ–¹æ¡ˆ**: å°†å‘é‡æ•°æ®åº“ç‹¬ç«‹éƒ¨ç½²,é€šè¿‡HTTP APIè¿æ¥,é¿å…åŸç”ŸäºŒè¿›åˆ¶ä¾èµ–ã€‚

---

## ğŸ“¦ æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **Qdrant** | æ€§èƒ½å¼ºã€åŠŸèƒ½å…¨ã€Web UI | éœ€é¢å¤–æœåŠ¡ | â­â­â­ |
| **ChromaDB** | ç®€å•ã€è½»é‡ | åŠŸèƒ½è¾ƒå°‘ | â­â­ |
| **ç»§ç»­LanceDB** | åµŒå…¥å¼ã€ç®€å• | åŸç”Ÿä¾èµ–é—®é¢˜ | â­ |

---

## ğŸš€ æ–¹æ¡ˆA: Qdrantéƒ¨ç½² (æ¨è)

### 1. å¯åŠ¨QdrantæœåŠ¡

```bash
cd /path/to/promptx-agenticRag

# å¯åŠ¨Qdrant
docker-compose -f docker-compose.qdrant.yml up -d

# æŸ¥çœ‹æ—¥å¿—
docker logs -f deechat-qdrant

# éªŒè¯æœåŠ¡
curl http://localhost:6333/
```

### 2. è®¿é—®Webç®¡ç†ç•Œé¢

æµè§ˆå™¨æ‰“å¼€: `http://ä½ çš„æœåŠ¡å™¨IP:6333/dashboard`

### 3. ä¿®æ”¹DeeChaté…ç½®

ç¼–è¾‘ `docker/.env`:

```bash
# å‘é‡æ•°æ®åº“é…ç½®
VECTOR_DB='qdrant'
QDRANT_ENDPOINT='http://qdrant:6333'  # Dockerå†…éƒ¨ç½‘ç»œ
# QDRANT_API_KEY='your-key'  # å¯é€‰,å–æ¶ˆæ³¨é‡Šå¯ç”¨è®¤è¯
```

### 4. é‡å¯DeeChat

```bash
# é‡æ–°æ„å»º(å¦‚æœéœ€è¦)
docker-compose build

# é‡å¯æœåŠ¡
docker-compose up -d
```

### 5. æµ‹è¯•éªŒè¯

ä¸Šä¼ æ–‡ä»¶åˆ°å·¥ä½œåŒº,æ£€æŸ¥æ˜¯å¦æ­£å¸¸:
- ä¸Šä¼ æˆåŠŸ âœ…
- ä¿å­˜åˆ°å·¥ä½œåŒº âœ…
- ä¸å†å´©æºƒ âœ…

---

## ğŸ“¦ æ–¹æ¡ˆB: ChromaDBéƒ¨ç½²

### 1. å¯åŠ¨ChromaDBæœåŠ¡

```bash
# å¯åŠ¨ChromaDB
docker-compose -f docker-compose.chromadb.yml up -d

# éªŒè¯æœåŠ¡
curl http://localhost:8000/api/v1/heartbeat
```

### 2. ä¿®æ”¹DeeChaté…ç½®

ç¼–è¾‘ `docker/.env`:

```bash
VECTOR_DB='chroma'
CHROMA_ENDPOINT='http://chromadb:8000'
# CHROMA_API_HEADER='X-Chroma-Token'  # å¯é€‰
# CHROMA_API_KEY='your-token'  # å¯é€‰
```

### 3. é‡å¯DeeChat

```bash
docker-compose up -d
```

---

## ğŸ”§ é«˜çº§é…ç½®

### å¯ç”¨Qdrantè®¤è¯

ç¼–è¾‘ `docker-compose.qdrant.yml`:

```yaml
environment:
  - QDRANT__SERVICE__API_KEY=your-super-secret-key-123456
```

å¯¹åº”ä¿®æ”¹ `docker/.env`:

```bash
QDRANT_API_KEY='your-super-secret-key-123456'
```

### æ•°æ®æŒä¹…åŒ–

ä¸¤ä¸ªæ–¹æ¡ˆéƒ½å·²é…ç½®æŒä¹…åŒ–:
- Qdrant: `./qdrant-data/`
- ChromaDB: `./chromadb-data/`

**å¤‡ä»½**:

```bash
# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.qdrant.yml stop

# å¤‡ä»½æ•°æ®
tar -czf qdrant-backup-$(date +%Y%m%d).tar.gz ./qdrant-data

# æ¢å¤æ•°æ®
tar -xzf qdrant-backup-20250102.tar.gz

# é‡å¯æœåŠ¡
docker-compose -f docker-compose.qdrant.yml up -d
```

---

## ğŸ›¡ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### 1. å¯ç”¨è®¤è¯ä¿æŠ¤

```yaml
# docker-compose.qdrant.yml
environment:
  - QDRANT__SERVICE__API_KEY=${QDRANT_SECRET_KEY}
```

### 2. é™åˆ¶ç«¯å£è®¿é—®

```yaml
ports:
  - "127.0.0.1:6333:6333"  # ä»…æœ¬åœ°è®¿é—®
```

å¦‚æœDeeChatå’ŒQdrantåœ¨åŒä¸€å°æœåŠ¡å™¨,ä¸éœ€è¦æš´éœ²ç«¯å£:

```yaml
# åˆ é™¤portsé…ç½®,ä»…é€šè¿‡Dockerå†…éƒ¨ç½‘ç»œè®¿é—®
# ports:
#   - "6333:6333"
```

### 3. èµ„æºé™åˆ¶

```yaml
deploy:
  resources:
    limits:
      cpus: '2.0'
      memory: 2G
    reservations:
      memory: 512M
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### Qdrant

è®¿é—® `http://localhost:6333/dashboard` æŸ¥çœ‹:
- é›†åˆæ•°é‡
- å‘é‡æ€»æ•°
- å†…å­˜ä½¿ç”¨
- æŸ¥è¯¢æ€§èƒ½

### ChromaDB

```bash
# æŸ¥çœ‹å¥åº·çŠ¶æ€
curl http://localhost:8000/api/v1/heartbeat

# æŸ¥çœ‹é›†åˆ
curl http://localhost:8000/api/v1/collections
```

---

## ğŸ”„ æ•°æ®è¿ç§»

å¦‚æœä»LanceDBè¿ç§»åˆ°Qdrant:

### æ–¹å¼1: é‡æ–°å‘é‡åŒ–(æ¨è)

1. åˆ‡æ¢é…ç½®åˆ°Qdrant
2. åœ¨DeeChatä¸­åˆ é™¤æ‰€æœ‰æ–‡æ¡£
3. é‡æ–°ä¸Šä¼ æ–‡æ¡£
4. ç³»ç»Ÿè‡ªåŠ¨ä½¿ç”¨Qdrantå­˜å‚¨

### æ–¹å¼2: ç¼–ç¨‹è¿ç§»(é«˜çº§)

éœ€è¦ç¼–å†™è¿ç§»è„šæœ¬,ä»LanceDBè¯»å–å‘é‡å¹¶å†™å…¥Qdrantã€‚

---

## â“ å¸¸è§é—®é¢˜

### Q1: Qdrant vs ChromaDB å¦‚ä½•é€‰æ‹©?

- **é€‰Qdrant**: ç”Ÿäº§ç¯å¢ƒ,éœ€è¦é«˜æ€§èƒ½å’ŒWeb UI
- **é€‰ChromaDB**: å¿«é€Ÿæµ‹è¯•,ç®€å•åœºæ™¯

### Q2: ä¼šä¸¢å¤±æ•°æ®å—?

ä¸ä¼šã€‚ä½¿ç”¨volumeæŒä¹…åŒ–å­˜å‚¨:
- Qdrant: `./qdrant-data/`
- ChromaDB: `./chromadb-data/`

### Q3: éœ€è¦ä¿®æ”¹ä»£ç å—?

**ä¸éœ€è¦**! ä½ çš„ä»£ç å·²å®Œæ•´æ”¯æŒ:
- `server/utils/vectorDbProviders/qdrant/index.js` (ç¬¬1è¡Œ)
- `server/utils/vectorDbProviders/chroma/index.js` (ç¬¬1è¡Œ)

åªéœ€ä¿®æ”¹ç¯å¢ƒå˜é‡å³å¯ã€‚

### Q4: æ€§èƒ½ä¼šä¸‹é™å—?

ä¸ä¼šã€‚HTTP APIçš„ç½‘ç»œå¼€é”€æå°(<1ms),è€Œä¸”:
- é¿å…äº†åŸç”Ÿä¾èµ–
- å¯ä»¥ç‹¬ç«‹æ‰©å±•
- Qdrantæ€§èƒ½æ›´ä¼˜äºLanceDB

### Q5: å¦‚ä½•å›æ»šåˆ°LanceDB?

```bash
# ä¿®æ”¹docker/.env
VECTOR_DB='lancedb'

# é‡å¯
docker-compose up -d
```

---

## ğŸ“ å®Œæ•´éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] åˆ›å»º `docker-compose.qdrant.yml`
- [ ] å¯åŠ¨QdrantæœåŠ¡
- [ ] éªŒè¯Qdrantå¥åº·çŠ¶æ€
- [ ] ä¿®æ”¹ `docker/.env` é…ç½®
- [ ] é‡å¯DeeChatæœåŠ¡
- [ ] ä¸Šä¼ æµ‹è¯•æ–‡ä»¶
- [ ] éªŒè¯å‘é‡åŒ–æˆåŠŸ
- [ ] é…ç½®æ•°æ®å¤‡ä»½
- [ ] (å¯é€‰)å¯ç”¨APIè®¤è¯
- [ ] (å¯é€‰)é…ç½®èµ„æºé™åˆ¶

---

## ğŸ‰ é¢„æœŸç»“æœ

éƒ¨ç½²æˆåŠŸå:

1. âœ… **ä¸å†å´©æºƒ**: æ— åŸç”Ÿä¾èµ–é—®é¢˜
2. âœ… **æ€§èƒ½æ›´å¥½**: Qdrantæ¯”LanceDBæ›´å¿«
3. âœ… **æ˜“äºç»´æŠ¤**: Web UIå¯è§†åŒ–ç®¡ç†
4. âœ… **ç”Ÿäº§å°±ç»ª**: è®¤è¯ã€å¤‡ä»½ã€ç›‘æ§é½å…¨
5. âœ… **å¯ç‹¬ç«‹æ‰©å±•**: å‘é‡æ•°æ®åº“å¯è¿ç§»åˆ°æ›´å¼ºæœåŠ¡å™¨

---

## ğŸ“ ä¸‹ä¸€æ­¥

é€‰æ‹©ä¸€ä¸ªæ–¹æ¡ˆç«‹å³å¼€å§‹:

```bash
# æ¨è: Qdrant
docker-compose -f docker-compose.qdrant.yml up -d

# æˆ–è€…: ChromaDB
docker-compose -f docker-compose.chromadb.yml up -d
```

ç„¶åä¿®æ”¹ `docker/.env` å¹¶é‡å¯DeeChat!